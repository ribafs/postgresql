


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
	<html>
	<head>
	 <title>mySQL to pgsql - Encrypt passwords</title>
	
	 <script type="text/javascript" src="/wiki/stylesheets/wikibits.js"></script>
	 <style type='text/css'>
  	  /*/*/ /*<![CDATA[*/
	  @import "/inc/default.css";
	  #quickbar { position: absolute; left: 0px; }
	  #article { margin-left: 141px; margin-right: 12px; }
	  a.new, #quickbar a.new { color: #CC2200; }
	  /*]]>*/ /* */
	 </style>

	</head>
	<body>
	
	
	
<div id='content'>

  	<div id='quickbar'>
				<p>
				<A href="/"><img src="/images/lamp.jpg"  border="0" alt="A LAMP Portal"></A></p>
				<br>
				<p>
				<a href="/linux/">Linux</a><br/>
				<a href="/java/">Java</a><br/>
				<a href="/php/">PHP</a><br/>
				<p>
				<hr width="50%">
				<p>
				<a href="/jabber/">Jabber</a><br/>
				<a href="/etc/">etc</a><br/>
				</p>
				<p>
				<A href="http://www.radinks.com"><IMG src="/images/drop-logo100.jpg" 
					width=100 height=100 border=0 style="margin-bottom: 30px; margin-top: 60px"
					 alt="The totally Rad Software Company - Sponsor"></A>
				</p>

	</div>
<div id='topbar'><table width='100%' border='0' cellspacing='0' cellpadding='8'><tr><td class='top' align='left' valign='middle' nowrap='nowrap'><a href='/'><span id='sitetitle'>Site With The Lamp</span></a></td></tr></table>
</div>
<div id='article'>
<h1 align='center'>password() vs md5()</h1><table class="newboxTable" align="right" clear="left">
 <tr><td class="newboxTitle"  align="center">New Articles</td></tr>
 <tr><td class="newboxText">
 	<p><a href="/java/swing/uidefaults.php">Java PLAF and UIDefaults.</a></p>
	<p><a href="/wiki/Timestamp">Comparision of Date and Time fields.</a></p>
	<p><a href="/wiki/SQL_numeric_types">Making up the numbers</a></p>
 </td></tr>
</table>

<p>We are halfway through migrating the rad user manager from mysql to postgresql. In the last step you may have pointed your browser to your Rad User installation and attempted to login, only to find that it does not just work yet. 
</p>

<p>The reason that you are still unable to login is that the code still uses the password() function of mysql, a function that is not availble in postgresql. Indeed the use of password() was a poor choice since it is not even compatible with older version of mysql. It would have been better to have used md5() instead - a function that is avialable on both postgresql and mysql. If in the future we need to make the system compatible with different database that does not support the md5() function we can then make use of the corresponding function in PHP.
</p>

<p>Since backward compatibility is another factor that we need to watch out for instead of blindly changing all occurances of password() to md5(), we will use another configuration setting to let the downloader have the option
of using the old password() function with mysql databases. Here is how signup.php looks like when we make the relevent changes:
</p>

<pre>
	if($user_password_function == 1)
	{
		$query = "insert into users SET
			userName = '$username',
			userPassword = password('$password'),
			userStatus =$userStatus";
	}
	else
	{
		$query = "insert into users SET
			userName = '$username',
			userPassword = md5('$password'),
			userStatus =$userStatus";
	}

</pre>

<p>We have to make similar changes in all other files where calls to the password() function including the login.php script. Even after making all those changes you will still find yourself unable to login to the system. That is because in certain places we use the mysql_num_rows() method to determine if a valid result set has been returned. Let's try to change that and a few more things in the <a href="timestamp.php">next step</a>.
</p>


<p>&nbsp;</p>
<div align="center" style="margin-left:-120px">
<table border=0 cellpadding=5>
 <tr><td bgcolor="#e0e0ff"> &nbsp; Part 1: &nbsp; </td>
     <td><a href="/postgres/">Getting Started</a> &nbsp; , &nbsp;
	<a href="/postgres/convert.php">The Schema</a> &nbsp; , &nbsp;
	<a href="/postgres/query.php">Queries</a>
    </td>
 </tr>
 <tr><td bgcolor="#e0e0ff"> &nbsp; Part 2: &nbsp; </td>
     <td><a href="/postgres/password.php">Passwords</a> &nbsp; , &nbsp;
	 <a href="/postgres/timestamp.php">Times Up</a> &nbsp; , &nbsp;
	 <a href="/postgres/error.php">Errors</a> &nbsp; , &nbsp;
	 <a href="/postgres/download.php">Download</a>
     </td>
 </tr>
</table>
</div>

	  </div>
	</div>
	<br clear='all' />
	<div id='footer'>
		<p style="margin-top:30px">&nbsp;</p>		
	    <hr width="45%" align="center">
		<p align="center">		
			<a href="/jabber/">Jabber</a> &nbsp;|&nbsp;
			<a href="/linux/">Linux</a> &nbsp;|&nbsp;
			<a href="/mysql/">mySQL</a> &nbsp;|&nbsp;
			<a href="/php/">PHP</a> &nbsp;|&nbsp;				
			<a href="/java/">Java</a>  &nbsp;|&nbsp;
			<a href="/sitemap.php">Site Map</a> &nbsp;|&nbsp;
			<a href="/wiki/">Wiki</a>
			
		</p>
		<p align="center">					
			<a href="/downloads/">Downloads</a> &nbsp;|&nbsp;
			<a href="/about.php">About</a> &nbsp;|&nbsp;
			<a href="/mysql/links.php">Links</a> &nbsp;|&nbsp;
			<a href="/contact.php">Contact</a> &nbsp;|&nbsp;
			<a href="/">Home</a>
		</p>
		<p>&nbsp;</p>
	   
<script type="text/javascript"><!--
google_ad_client = "pub-6509966129456920";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
//--></script>
	
	<p align="center">
		<script type="text/javascript"
		src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
		</script>  
	</p>
		<p>&nbsp;</p>
		<p align=center>Copyright &copy; Raditha Dissanayake 2005</p>

		<p align=center  style="font-size:90%" >
		<a href="/terms.php">Terms of Use</a>  &nbsp;|&nbsp;
		<a href="/privacy.php">Privacy</a>
		</p>
	
  </div>
  
 </body>
</html>

