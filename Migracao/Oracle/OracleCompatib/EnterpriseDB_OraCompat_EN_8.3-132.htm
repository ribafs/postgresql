<html><head>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"><title>Oracle Compatibility Developer&#8217;s Guide</title>

<meta name="GENERATOR" content="HTML Transit 8.0 Trial Version by Avantstar, Inc. www.avantstar.com">
<meta name="TransitPubID" content="2069"><style type="text/css">
<!--
	.Title-1
	{
		text-align: center
	}
	.Heading1-1
	{
		text-align: left
	}
-->
</style></head><body><a name="TopOfPage"> </a>
<!-- TRANSIT - INFOBEFORE -->
<a href="http://www.enterprisedb.com/index.do?lpage=true"><img alt="EnterpriseDB" src="EnterpriseDB_OraCompat_EN_8.3-132_arquivos/logo.gif" border="0"></a><p style="text-align: center;"><a href="http://www.enterprisedb.com/docs/en/8.3/oracompat/EnterpriseDB_OraCompat_EN_8.3-131.htm#TopOfPage"><img src="EnterpriseDB_OraCompat_EN_8.3-132_arquivos/inveppv.gif" alt="Previous Page" border="0"></a><!-- TRANSIT - TOC --><a href="http://www.enterprisedb.com/docs/en/8.3/oracompat/Table%20of%20Contents.htm#TopOfPage" target="_top"><img src="EnterpriseDB_OraCompat_EN_8.3-132_arquivos/invetoc.gif" alt="Table Of Contents" border="0"></a><a href="http://www.enterprisedb.com/docs/en/8.3/oracompat/EnterpriseDB_OraCompat_EN_8.3-133.htm#TopOfPage"><img src="EnterpriseDB_OraCompat_EN_8.3-132_arquivos/invepnx.gif" alt="Next Page" border="0"></a></p>

  <div style="margin-left: 36pt;"><p><a name="P6898_387250"></a><span style="font-family: 'Arial'; font-size: 13pt;">4.4.3 SELECT INTO</span></p>

</div><p><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">The </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">SELECT INTO</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> statement is an </span><span style="font-family: 'Times New Roman'; font-size: 12pt;">SPL</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> variation of</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> the </span><span style="font-family: 'Times New Roman'; font-size: 12pt;">SQL</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">SELECT</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> command, the differences being:</span></p>

  <div style="margin-left: 36pt;"><p><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">&#9679; </span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">That </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">SELECT INTO</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> is designed to assign the results to variables or records where they can then be used in </span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">SPL</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> program statements.</span></p>

  <p><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">&#9679; </span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">The accessible result set of </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">SELECT INTO</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> is at most one row.</span></p>

</div><p><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">Other than the above, all of the clauses of the </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">SELECT</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> command such as </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">WHERE</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">, </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">ORDER BY</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">, </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">GROUP BY</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">, </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">HAVING</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">, etc. are valid for </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">SELECT INTO</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">. The following are the two variations of </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">SELECT INTO</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">.</span></p><div style="margin-left: 24pt;"><pre><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">SELE</span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">CT </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;"><i>select_expressions</i></span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;"> INTO </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;"><i>target</i></span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;"> FROM ...;</span></pre>

</div><p><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;"><i>target</i></span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> is a comma-separated list of simple variables</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">.</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;"><i>select_expressions</i></span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> and the remainder of the statement are the same as for the </span><span style="font-family: 'Times New Roman'; font-size: 12pt;"><u><a href="http://www.enterprisedb.com/docs/en/8.3/oracompat/EnterpriseDB_OraCompat_EN_8.3-86.htm#P3860_222577">SELECT</a></u></span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> </span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">command</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">.</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> </span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">The selected values mu</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">st exactly match in data type, number, and order the structure of the tar</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">get or a </span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">runtime</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> error occurs.</span></p><div style="margin-left: 24pt;"><pre><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">SELECT * INTO </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;"><i>record</i></span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;"> FROM </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;"><i>table</i></span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;"> ...;</span></pre>

</div><p><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;"><i>record</i></span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> is a record variable that has previously been declared.</span></p>

<p><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">If
the query returns zero rows, null values are assigned to the target(s).
If the query returns multiple rows, the first row is assigned to the
target(s) and the rest are discarded. (Note that </span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">"the first row"</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> is not well-defined unless you&#8217;ve used </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">ORDER BY</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">.)</span></p>

<p><b><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">Note:</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> </span></b><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">In </span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">either cases, where no row is returned o</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">r</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> more than one row is returned, </span><span style="font-family: 'Times New Roman'; font-size: 12pt;">SPL</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> throws an exception.</span></p>

<p><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"><b>Note:</b></span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> There is a variation of </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">SELECT INTO</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> using the </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">BULK COLLECT</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> clause that allows a result set of more than one row that is returned into a collection. See Section <u><a href="http://www.enterprisedb.com/docs/en/8.3/oracompat/EnterpriseDB_OraCompat_EN_8.3-168.htm#P8986_481569">4.9.4.1</a></u> for more information on using the </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">BULK COLLECT</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> clause with the </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">SELECT INTO</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> statement.</span></p>

<p><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">You can use the </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">WHEN NO_DATA_FOUND</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> clause in an </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">EXCEPTION</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> block to determine whether the assignment was successful (that is, at least one row was returned by the query).</span></p>

<p><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">This version of the </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">emp_sal_query</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> procedure uses the variation of </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">SELECT INTO</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> that returns the result set into a record. Also note the addition of the </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">EXCEPTION</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> block containing the </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">WHEN NO_DATA_FOUND</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> conditional expression.</span></p><div style="margin-left: 12pt;"><pre><span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">CREATE OR REPLACE PROCEDURE emp_sal_query (</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">    p_empno         IN emp.empno%TYPE</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">)</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">IS</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">    r_emp           emp%ROWTYPE;</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">    v_avgsal        emp.sal%TYPE;</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">BEGIN</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">    SELECT * INTO r_emp</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">        FROM emp WHERE empno = p_empno;</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">    DBMS_OUTPUT.PUT_LINE('Employee # : ' || p_empno);</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">    DBMS_OUTPUT.PUT_LINE('Name       : ' || r_emp.ename);</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">    DBMS_OUTPUT.PUT_LINE('Job        : ' || r_emp.job);</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">    DBMS_OUTPUT.PUT_LINE('Hire Date  : ' || r_emp.hiredate);</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">    DBMS_OUTPUT.PUT_LINE('Salary     : ' || r_emp.sal);</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">    DBMS_OUTPUT.PUT_LINE('Dept #     : ' || r_emp.deptno);</span>

<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">    SELECT AVG(sal) INTO v_avgsal</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">        FROM emp WHERE deptno = r_emp.deptno;</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">    IF r_emp.sal &gt; v_avgsal THEN</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">        DBMS_OUTPUT.PUT_LINE('Employee''s salary is more than the '</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">            || 'department average of ' || v_avgsal);</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">    ELSE</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">        DBMS_OUTPUT.PUT_LINE('Employee''s salary does not exceed the '</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">            || 'department average of ' || v_avgsal);</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">    END IF;</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">EXCEPTION</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">    WHEN NO_DATA_FOUND THEN</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">        DBMS_OUTPUT.PUT_LINE('Employee # ' || p_empno || ' not found');</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">END;</span></pre>

</div><p><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">If the query is executed with a non-existent employee number the results appear as follows.</span></p><div style="margin-left: 12pt;"><pre><span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">EXEC emp_sal_query(0);</span>

<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">Employee # 0 not found</span></pre>

</div><p><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">Another conditional clause of use in the </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">EXCEPTION</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> section with </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">SELECT INTO</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> is the </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">TOO</span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">_MANY_ROWS</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> exception</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">.</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> </span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">If more than one row is selected by the </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">SELECT INTO</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> statement an exception is thrown by </span><span style="font-family: 'Times New Roman'; font-size: 12pt;">SPL</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">.</span></p>

<p><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">When the following block is executed, the </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">TOO_MANY_ROWS</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> exception is thrown since there are many employees in the specified department.</span></p><div style="margin-left: 12pt;"><pre><span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">DECLARE</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">    v_ename         emp.ename%TYPE;</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">BEGIN</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">    SELECT ename INTO v_ename FROM emp WHERE deptno = 20 ORDER BY ename;</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">EXCEPTION</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">    WHEN TOO_MANY_ROWS THEN</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">        DBMS_OUTPUT.PUT_LINE('More than one employee found');</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">        DBMS_OUTPUT.PUT_LINE('First employee returned is ' || v_ename);</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">END;</span>

<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">More than one employee found</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">First employee returned is ADAMS</span></pre>

</div><p><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"><b>Note:</b></span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> </span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">See Section </span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"><u><a href="http://www.enterprisedb.com/docs/en/8.3/oracompat/EnterpriseDB_OraCompat_EN_8.3-143.htm#P7788_428154">4.5.5</a></u></span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> </span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">or more inf</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">ormation on exception handling.</span></p>

<p style="text-align: center;"><a href="http://www.enterprisedb.com/docs/en/8.3/oracompat/EnterpriseDB_OraCompat_EN_8.3-131.htm#TopOfPage"><img src="EnterpriseDB_OraCompat_EN_8.3-132_arquivos/inveppv.gif" alt="Previous Page" border="0"></a><!-- TRANSIT - TOC --><a href="http://www.enterprisedb.com/docs/en/8.3/oracompat/Table%20of%20Contents.htm#TopOfPage" target="_top"><img src="EnterpriseDB_OraCompat_EN_8.3-132_arquivos/invetoc.gif" alt="Table Of Contents" border="0"></a><a href="http://www.enterprisedb.com/docs/en/8.3/oracompat/EnterpriseDB_OraCompat_EN_8.3-133.htm#TopOfPage"><img src="EnterpriseDB_OraCompat_EN_8.3-132_arquivos/invepnx.gif" alt="Next Page" border="0"></a></p>

<a href="http://www.avantstar.com/"><img src="EnterpriseDB_OraCompat_EN_8.3-132_arquivos/transpwr.gif" alt="Powered by Transit"></a><!-- TRANSIT - INFOAFTER -->
<script type="text/javascript"> 
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www."); 
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E")); 
</script><script src="EnterpriseDB_OraCompat_EN_8.3-132_arquivos/ga.js" type="text/javascript"></script> 
<script type="text/javascript"> 
var pageTracker = _gat._getTracker("UA-4413916-2"); 
pageTracker._initData(); 
pageTracker._trackPageview(); 
</script> 
</body></html>