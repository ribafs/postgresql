<html><head>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"><title>Oracle Compatibility Developer&#8217;s Guide</title>

<meta name="GENERATOR" content="HTML Transit 8.0 Trial Version by Avantstar, Inc. www.avantstar.com">
<meta name="TransitPubID" content="2124"><style type="text/css">
<!--
	.Title-1
	{
		text-align: center
	}
	.Heading1-1
	{
		text-align: left
	}
-->
</style></head><body><a name="TopOfPage"> </a>
<!-- TRANSIT - INFOBEFORE -->
<a href="http://www.enterprisedb.com/index.do?lpage=true"><img alt="EnterpriseDB" src="EnterpriseDB_OraCompat_EN_8.3-187_arquivos/logo.gif" border="0"></a><p style="text-align: center;"><a href="http://www.enterprisedb.com/docs/en/8.3/oracompat/EnterpriseDB_OraCompat_EN_8.3-186.htm#TopOfPage"><img src="EnterpriseDB_OraCompat_EN_8.3-187_arquivos/inveppv.gif" alt="Previous Page" border="0"></a><!-- TRANSIT - TOC --><a href="http://www.enterprisedb.com/docs/en/8.3/oracompat/Table%20of%20Contents.htm#TopOfPage" target="_top"><img src="EnterpriseDB_OraCompat_EN_8.3-187_arquivos/invetoc.gif" alt="Table Of Contents" border="0"></a><a href="http://www.enterprisedb.com/docs/en/8.3/oracompat/EnterpriseDB_OraCompat_EN_8.3-188.htm#TopOfPage"><img src="EnterpriseDB_OraCompat_EN_8.3-187_arquivos/invepnx.gif" alt="Next Page" border="0"></a></p>

  <div style="margin-left: 36pt;"><p><a name="P9587_522428"></a><span style="font-family: 'Arial'; font-size: 13pt;">6.2.2 Creating the Package Body</span></p>

</div><p><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"><a name="P9588_522459"></a>The body of the package contains the actual implementation behind the package specification</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">.</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> </span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">For the above </span><span style="font-family: 'Courier New'; font-size: 11pt; color: Black;">emp_admin</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> package specification, we shall now create a package bo</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">dy which will implement the specifications</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">.</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;"> </span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">The body will contain the implementation of the functions and stored p</span><span style="font-family: 'Times New Roman'; font-size: 12pt; color: Black;">rocedures in the specification.</span></p><div style="margin-left: 12pt;"><pre><span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">--</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">--  Package body for the 'emp_admin' package.</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">--</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">CREATE OR REPLACE PACKAGE BODY emp_admin</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">IS</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   --</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   --  Function that queries the 'dept' table based on the department</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   --  number and returns the corresponding department name.</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   --</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   FUNCTION get_dept_name (</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      p_deptno        IN NUMBER DEFAULT 10</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   ) </span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   RETURN VARCHAR2</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   IS</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      v_dname         VARCHAR2(14);</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   BEGIN</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      SELECT dname INTO v_dname FROM dept WHERE deptno = p_deptno;</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      RETURN v_dname;</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   EXCEPTION</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      WHEN NO_DATA_FOUND THEN</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">         DBMS_OUTPUT.PUT_LINE('Invalid department number ' || p_deptno);</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">         RETURN '';</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   END;</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   --</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   --  Function that updates an employee's salary based on the</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   --  employee number and salary increment/decrement passed</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   --  as IN parameters.  Upon successful completion the function</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   --  returns the new updated salary.</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   --</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   FUNCTION update_emp_sal (</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      p_empno         IN NUMBER,</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      p_raise         IN NUMBER</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   ) </span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   RETURN NUMBER</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   IS</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      v_sal           NUMBER := 0;</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   BEGIN</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      SELECT sal INTO v_sal FROM emp WHERE empno = p_empno;</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      v_sal := v_sal + p_raise;</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      UPDATE emp SET sal = v_sal WHERE empno = p_empno;</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      RETURN v_sal;</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   EXCEPTION</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      WHEN NO_DATA_FOUND THEN</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">         DBMS_OUTPUT.PUT_LINE('Employee ' || p_empno || ' not found');</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">         RETURN -1;</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      WHEN OTHERS THEN</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">         DBMS_OUTPUT.PUT_LINE('The following is SQLERRM:');</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">         DBMS_OUTPUT.PUT_LINE(SQLERRM);</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">         DBMS_OUTPUT.PUT_LINE('The following is SQLCODE:');</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">         DBMS_OUTPUT.PUT_LINE(SQLCODE);</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">         RETURN -1;</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   END;</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   --</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   --  Procedure that inserts a new employee record into the 'emp' table.</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   --</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   PROCEDURE hire_emp (</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      p_empno         NUMBER,</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      p_ename         VARCHAR2,</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      p_job           VARCHAR2,</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      p_sal           NUMBER,</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      p_hiredate      DATE    DEFAULT sysdate,</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      p_comm          NUMBER  DEFAULT 0,</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      p_mgr           NUMBER,</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      p_deptno        NUMBER  DEFAULT 10</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   )</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   AS</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   BEGIN</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      INSERT INTO emp(empno, ename, job, sal, hiredate, comm, mgr, deptno)</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">         VALUES(p_empno, p_ename, p_job, p_sal,</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">                p_hiredate, p_comm, p_mgr, p_deptno);</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   END;</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   --</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   --  Procedure that deletes an employee record from the 'emp' table based</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   --  on the employee number.</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   --</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   PROCEDURE fire_emp (</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      p_empno         NUMBER</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   )</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   AS</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   BEGIN</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">      DELETE FROM emp WHERE empno = p_empno;</span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">   END; </span>
<span style="font-family: 'Courier New'; font-size: 9pt; color: rgb(46, 49, 146);">END;</span></pre>

<p style="text-align: center;"><a href="http://www.enterprisedb.com/docs/en/8.3/oracompat/EnterpriseDB_OraCompat_EN_8.3-186.htm#TopOfPage"><img src="EnterpriseDB_OraCompat_EN_8.3-187_arquivos/inveppv.gif" alt="Previous Page" border="0"></a><!-- TRANSIT - TOC --><a href="http://www.enterprisedb.com/docs/en/8.3/oracompat/Table%20of%20Contents.htm#TopOfPage" target="_top"><img src="EnterpriseDB_OraCompat_EN_8.3-187_arquivos/invetoc.gif" alt="Table Of Contents" border="0"></a><a href="http://www.enterprisedb.com/docs/en/8.3/oracompat/EnterpriseDB_OraCompat_EN_8.3-188.htm#TopOfPage"><img src="EnterpriseDB_OraCompat_EN_8.3-187_arquivos/invepnx.gif" alt="Next Page" border="0"></a></p>

<a href="http://www.avantstar.com/"><img src="EnterpriseDB_OraCompat_EN_8.3-187_arquivos/transpwr.gif" alt="Powered by Transit"></a><!-- TRANSIT - INFOAFTER -->
<script type="text/javascript"> 
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www."); 
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E")); 
</script><script src="EnterpriseDB_OraCompat_EN_8.3-187_arquivos/ga.js" type="text/javascript"></script> 
<script type="text/javascript"> 
var pageTracker = _gat._getTracker("UA-4413916-2"); 
pageTracker._initData(); 
pageTracker._trackPageview(); 
</script> 
</div></body></html>